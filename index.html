<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>geoLocus</title>
  <!-- Huvudstilark√§lla -->
  <link rel="stylesheet" href="style.css">
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jersey+10&display=swap" rel="stylesheet">
  <!-- Leaflet CSS (f√∂r kartan) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <!-- Font Awesome f√∂r ikoner -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
  <div class="wrapper">
    <header id="header">
      <div id="logo-container">
        <img src="geoLocus_small.png" alt="geoLocus logotyp" id="logo">
      </div>
      <nav class="tab-wrapper">
        <div class="tab-container">
          <button class="tab-button" onclick="openTab('main')">Karta</button>
          <button class="tab-button" onclick="openTab('converter')">Konvertera</button>
          <button class="tab-button" onclick="openTab('h√§mta-geodata')">H√§mta geodata</button>
        </div>
      </nav>
    </header>

    <!-- Inneh√•llsomslag f√∂r alla flikar -->
    <div class="content">
      <div id="main" class="tab-content">
        <main class="container">
          <!-- Rubriker -->
          <h2>Hitta platsens l√§n, kommun, landskap och lappmark</h2>
          <p>Anv√§nd s√∂kfunktionen eller klicka direkt i kartan. OBS: platsnamn i kartan syns b√§st i Chrome.</p>
          
          <!-- üîç Kombinerad s√∂kning efter plats eller koordinater -->
          <section id="search-section">
            <div id="search">
              <input id="searchField" type="text" placeholder="S√∂k plats eller lat, lon (WGS84)" />
              <button id="searchButton">S√∂k</button>
              <!-- Visar resultatlista fr√•n plats-s√∂kning -->
              <div id="results"></div>
            </div>
          </section>
          
          <!-- üó∫Ô∏è Karta -->
          <section id="map-section">
            <div id="map"></div>
          </section>
          
          <!-- ‚ÑπÔ∏è S√∂ktips -->
          <section id="search-tips">
            <h3>S√∂ktips</h3>
            <details>
              <summary>Klicka f√∂r att visa</summary>
              <ul>
                <li>Du kan s√∂ka p√• ortnamn, sj√∂ar, b√§ckar, v√§gnummer, trafikplatser, byggnader, restauranger m.m.</li>
                <li>Mata in latitud och longitud (WGS84 dec) f√∂r att s√∂ka p√• koordinater, t.ex. 56.1234, 14.2465</li>
                <li>F√∂r att hitta l√§nsv√§gar (LV), s√∂k p√• <a href="https://sv.wikipedia.org/wiki/L%C3%A4nsbokstav" target="_blank" rel="noopener noreferrer">l√§nsbokstav</a> + v√§gnummer, t.ex. AB 1035</li>
                <li>Riksv√§gar (RV) inleds inte med n√•gon bokstav</li>
                <li>Listan med f√∂rslag som visas efter en s√∂kning √§r begr√§nsad till 10 tr√§ffar</li>
                <li>Platss√∂k visar endast tr√§ffar i Sverige</li>
              </ul>
            </details>
          </section>
          
          <br>
          
          <!-- ‚ÑπÔ∏è Datak√§llor -->
          <section id="data-sources">
            <h3>Datak√§llor</h3>
            <p>Bakgrundskartan kommer fr√•n OpenStreetMap. Information om adress, kommun och l√§n h√§mtas via Nominatims geokodningstj√§nst.</p>
            <p>Lagren som kan t√§ndas och sl√§ckas i kartan baseras p√•:</p>
            <ul>
              <li>L√§n: Lantm√§teriets Sverigekartor</li>
              <li>Kommun: Lantm√§teriets Sverigekartor</li>
              <li>Landskap: Lantm√§teriets distriktsindelning</li>
              <li>Lappmarkerna √§r avgr√§nsade med hj√§lp av kommungr√§nser</li>
            </ul>
            <p>Information om l√§n och kommun kan skilja sig mellan OpenStreetMap/Nominatim och Lantm√§teriets data, s√§rskilt om punkten ligger mycket n√§ra en gr√§ns.</p>
          </section>
          <br>
        </main>
      </div>

      <div id="converter" class="tab-content" style="display: none;">
        <main class="container">
          <!-- üîÑ Koordinatkonvertering -->
          <h2>Konvertera koordinater</h2>
          <section id="coordinate-converter" class="converter-container">
            <!-- Inmatningsf√§lt -->
            <div class="converter-fields">
              <input type="text" id="wgs84Input" placeholder="WGS84 (Lat, Lon)">
              <input type="text" id="rt90Input" placeholder="RT90 (X, Y)">
              <input type="text" id="swerefInput" placeholder="SWEREF 99 (X, Y)">
              <button id="convertButton">Konvertera</button>
            </div>
            <br>
            <!-- Resultat -->
            <div id="conversion-results">
              <h3>Resultat:</h3>
              <p><strong>WGS84:</strong> <span id="wgs84Result">-</span></p>
              <p><strong>RT90:</strong> <span id="rt90Result">-</span></p>
              <p><strong>SWEREF99:</strong> <span id="swerefResult">-</span></p>
            </div>
          </section>
        </main>
      </div>

      <div id="h√§mta-geodata" class="tab-content" style="display: none;">
        <main class="container">
          <!-- üìÇ H√§mta geodata fr√•n koordinater -->
          <section id="geo-instructions">
            <h2>H√§mta geodata fr√•n koordinater</h2>
            <p>Ladda upp en Excel-fil med koordinater och f√• tillbaka en fil d√§r varje punkt kopplas till l√§n, landskap (eller lappmark) och kommun.</p>
            <ol>
              <li>V√§lj din Excel-fil</li>
              <li>Klicka p√• <strong>"H√§mta geodata"</strong></li>
              <li>Den bearbetade filen laddas ner automatiskt</li>
            </ol>
            <!-- Filuppladdning f√∂r Excel + knapp f√∂r att starta bearbetning -->
            <div id="excel-upload">
              <label for="excelFile" class="custom-file-upload">
                <i class="fas fa-upload"></i> V√§lj fil
              </label>
              <input type="file" id="excelFile" accept=".xlsx,.xls" />
              <button id="processBtn">H√§mta geodata</button>
              <!-- Visar valt filnamn -->
              <span id="selectedFileName" class="file-info"></span>
            </div>
            <br>
            <!-- üìë Filformat & krav -->
            <h3>Filformat & krav</h3>
            <p>Filen du laddar upp ska vara i <strong>Excel-format</strong> (<code>.xlsx</code> eller <code>.xls</code>) och inneh√•lla f√∂ljande kolumner:</p>
            <table>
              <tbody>
                <tr>
                  <td><code>id</code></td>
                  <td>Unikt rad-ID (t.ex. katalognummer eller lokal-id; <em>valfritt</em>)</td>
                </tr>
                <tr>
                  <td><code>lat</code></td>
                  <td>Latitud i decimaltal</td>
                </tr>
                <tr>
                  <td><code>lon</code></td>
                  <td>Longitud i decimaltal</td>
                </tr>
              </tbody>
            </table>
            <br>
            <!-- ‚ÑπÔ∏è Viktig information -->
            <h3>Viktigt</h3>
            <ul>
              <li>Kolumnnamnen m√•ste skrivas exakt som ovan (sm√• bokst√§ver)</li>
              <li>Koordinaterna ska vara i WGS84</li>
              <li>Decimaler ska anges med punkt (<code>.</code>), inte komma (<code>,</code>)</li>
              <li>N√§r du h√§mtar geodata baseras l√§n och kommun p√• data fr√•n Lantm√§teriet, inte OpenStreetMap</li>
            </ul>
          </section>
        </main>
      </div>
    </div> <!-- .content -->

    <!-- Gemensam footer f√∂r alla flikar -->
    <footer>
      <a href="https://github.com/alotsa" target="_blank" class="github-link">
        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/github.svg" alt="GitHub" class="github-icon">
      </a>
    </footer>
  </div> <!-- .wrapper -->

  <!-- Skript -->
  <!-- Externa bibliotek -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6.5.0/turf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.js"></script>
  <!-- Din egen JavaScript-fil -->
  <script src="script.js"></script>
</body>
</html>
